(file (unit (unitHead unit (namespaceName (ident PersonController)) ;) (unitInterface interface (usesClause uses (namespaceNameList (namespaceName (ident classPerson)) , (namespaceName (ident classContact)) , (namespaceName (ident ClientModuleUnit1)) , (namespaceName (ident Misc)) , (namespaceName (ident Data) . (ident FireDACJSONReflect)) , (namespaceName (ident SysUtils)) ;)) (interfaceDecl (procDecl (procDeclHeading procedure (ident SetPeople) (formalParameterSection ( (formalParameterList (formalParameter (identListFlat (ident ClientID)) : (typeDecl (typeId (namespacedQualifiedIdent (qualifiedIdent (ident Integer))))))) ))) ;)) (interfaceDecl (procDecl (procDeclHeading procedure (ident PersonFields) (formalParameterSection ( (formalParameterList (formalParameter (identListFlat (ident Person)) : (typeDecl (typeId (namespacedQualifiedIdent (qualifiedIdent (ident TPerson))))))) ))) ;)) (interfaceDecl (procDecl (procDeclHeading procedure (ident ContactFields) (formalParameterSection ( (formalParameterList (formalParameter (identListFlat (ident Contact)) : (typeDecl (typeId (namespacedQualifiedIdent (qualifiedIdent (ident TContact)))))) ; (formalParameter (identListFlat (ident PersonID)) : (typeDecl (typeId (namespacedQualifiedIdent (qualifiedIdent (ident Integer))))))) ))) ;)) interfaceDecl (interfaceDecl procedure AddPerson ( Person : TPerson ; Contacts : Array of TContact ) ;) interfaceDecl (interfaceDecl procedure EditPerson ( Person : TPerson ; Contacts : Array of TContact ) ;) (interfaceDecl (procDecl (procDeclHeading procedure (ident DeletePerson) (formalParameterSection ( (formalParameterList (formalParameter (identListFlat (ident PersonID)) : (typeDecl (typeId (namespacedQualifiedIdent (qualifiedIdent (ident Integer))))))) ))) ;))) (unitImplementation implementation (usesClause uses (namespaceNameList (namespaceName (ident DataController)) , (namespaceName (ident PersonView)) ;)) (declSection (procDecl (procDeclHeading procedure (ident SetPeople) (formalParameterSection ( (formalParameterList (formalParameter (identListFlat (ident ClientID)) : (typeDecl (typeId (namespacedQualifiedIdent (qualifiedIdent (ident Integer))))))) ))) ; (procBody (block (declSection (varSection (varKey var) (varDeclaration (identListFlat (ident LDataSetList)) : (typeDecl (typeId (namespacedQualifiedIdent (qualifiedIdent (ident TFDJSONDataSets))))) ;) (varDeclaration (identListFlat (ident Person)) : (typeDecl (typeId (namespacedQualifiedIdent (qualifiedIdent (ident TPerson))))) ;) (varDeclaration (identListFlat (ident Contact)) : (typeDecl (typeId (namespacedQualifiedIdent (qualifiedIdent (ident TContact))))) ;) (varDeclaration (identListFlat (ident I)) : (typeDecl (typeId (namespacedQualifiedIdent (qualifiedIdent (ident Integer))))) ;) (varDeclaration (identListFlat (ident J)) : (typeDecl (typeId (namespacedQualifiedIdent (qualifiedIdent (ident Integer))))) ;))) (blockBody (compoundStatement begin (statementList (statement (simpleStatement (designator (namespacedQualifiedIdent (namespaceName (ident Module) . (ident mtPerson)) . (qualifiedIdent (ident Close)))))) ; (statement (simpleStatement (designator (namespacedQualifiedIdent (namespaceName (ident Module) . (ident mtContact)) . (qualifiedIdent (ident Close)))))) ; (statement (simpleStatement (designator (namespacedQualifiedIdent (qualifiedIdent (ident LDataSetList)))) := (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (namespaceName (ident ClientModule1) . (ident ServerMethods1Client)) . (qualifiedIdent (ident GetPeople))) (designatorItem ( (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (qualifiedIdent (ident ClientID))))))) )))))))) ; (statement (simpleStatement (designator (namespacedQualifiedIdent (namespaceName (ident Module) . (ident mtPerson)) . (qualifiedIdent (ident AppendData))) (designatorItem ( (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (namespaceName (ident TFDJSONDataSetsReader)) . (qualifiedIdent (ident GetListValue))) (designatorItem ( (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (qualifiedIdent (ident LDataSetList))))))) , (expression (simpleExpression (factor (intNum 0)))) )))))) ))))) ; (statement (simpleStatement (designator (namespacedQualifiedIdent (namespaceName (ident Module) . (ident mtPerson)) . (qualifiedIdent (ident Open)))))) ; (statement (simpleStatement (designator (namespacedQualifiedIdent (qualifiedIdent (ident LDataSetList)))) := (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (namespaceName (ident ClientModule1) . (ident ServerMethods1Client)) . (qualifiedIdent (ident GetContacts))) (designatorItem ( (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (namespaceName (ident Module) . (ident mtClient) . (ident Table)) . (qualifiedIdent (ident Rows))) (designatorItem [ (expressionList (expression (simpleExpression (factor (intNum 0))))) ]) (designatorItem . (ident GetValues)) (designatorItem ( (expression (simpleExpression (factor (stringFactor 'ClientID')))) )))))) )))))))) ; (statement (simpleStatement (designator (namespacedQualifiedIdent (namespaceName (ident Module) . (ident mtContact)) . (qualifiedIdent (ident AppendData))) (designatorItem ( (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (namespaceName (ident TFDJSONDataSetsReader)) . (qualifiedIdent (ident GetListValue))) (designatorItem ( (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (qualifiedIdent (ident LDataSetList))))))) , (expression (simpleExpression (factor (intNum 0)))) )))))) ))))) ; (statement (simpleStatement (designator (namespacedQualifiedIdent (namespaceName (ident Module) . (ident mtContact)) . (qualifiedIdent (ident Open)))))) ; (statement (ifStatement if (expression (simpleExpression (factor not (factor (designator (namespacedQualifiedIdent (namespaceName (ident Module) . (ident mtPerson)) . (qualifiedIdent (ident IsEmpty)))))))) then (statement (compoundStatement begin (statementList (statement (simpleStatement (designator (namespacedQualifiedIdent (namespaceName (ident Module) . (ident mtPerson)) . (qualifiedIdent (ident First)))))) ; (statement (simpleStatement (designator (namespacedQualifiedIdent (namespaceName (ident PersonView)) . (qualifiedIdent (ident ClearListBox)))))) ; (statement (forStatement for (designator (namespacedQualifiedIdent (qualifiedIdent (ident I)))) := (expression (simpleExpression (factor (intNum 0)))) to (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (namespaceName (ident Module) . (ident mtPerson) . (ident Table) . (ident Rows)) . (qualifiedIdent (ident Count))))) (operator -) (factor (intNum 1)))) do (statement (compoundStatement begin (statementList (statement (simpleStatement (designator (namespacedQualifiedIdent (qualifiedIdent (ident Person)))) := (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (namespaceName (ident TPerson)) . (qualifiedIdent (ident Create))) (designatorItem ( (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (namespaceName (ident Module) . (ident mtPerson) . (ident Fields)) . (qualifiedIdent (ident FieldByName))) (designatorItem ( (expression (simpleExpression (factor (stringFactor 'PersonID')))) )) (designatorItem . (ident Value)))))) , (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (namespaceName (ident Module) . (ident mtClient) . (ident Fields)) . (qualifiedIdent (ident FieldByName))) (designatorItem ( (expression (simpleExpression (factor (stringFactor 'ClientID')))) )) (designatorItem . (ident Value)))))) , (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (qualifiedIdent (ident IfNull))) (designatorItem ( (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (namespaceName (ident Module) . (ident mtPerson) . (ident Fields)) . (qualifiedIdent (ident FieldByName))) (designatorItem ( (expression (simpleExpression (factor (stringFactor 'LastName')))) )) (designatorItem . (ident Value)))))) , (expression (simpleExpression (factor (stringFactor '')))) )))))) , (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (qualifiedIdent (ident IfNull))) (designatorItem ( (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (namespaceName (ident Module) . (ident mtPerson) . (ident Fields)) . (qualifiedIdent (ident FieldByName))) (designatorItem ( (expression (simpleExpression (factor (stringFactor 'FirstName')))) )) (designatorItem . (ident Value)))))) , (expression (simpleExpression (factor (stringFactor '')))) )))))) , (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (qualifiedIdent (ident IfNull))) (designatorItem ( (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (namespaceName (ident Module) . (ident mtPerson) . (ident Fields)) . (qualifiedIdent (ident FieldByName))) (designatorItem ( (expression (simpleExpression (factor (stringFactor 'Notes')))) )) (designatorItem . (ident Value)))))) , (expression (simpleExpression (factor (stringFactor '')))) )))))) )))))))) ; (statement (simpleStatement (designator (namespacedQualifiedIdent (namespaceName (ident PersonView)) . (qualifiedIdent (ident AddPersonToListBox))) (designatorItem ( (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (qualifiedIdent (ident Person))))))) ))))) ; (statement (simpleStatement (designator (namespacedQualifiedIdent (namespaceName (ident Module) . (ident mtContact)) . (qualifiedIdent (ident First)))))) ; (statement (forStatement for (designator (namespacedQualifiedIdent (qualifiedIdent (ident J)))) := (expression (simpleExpression (factor (intNum 0)))) to (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (namespaceName (ident Module) . (ident mtContact) . (ident Table) . (ident Rows)) . (qualifiedIdent (ident Count))))) (operator -) (factor (intNum 1)))) do (statement (compoundStatement begin (statementList (statement (ifStatement if (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (namespaceName (ident Module) . (ident mtContact) . (ident Fields)) . (qualifiedIdent (ident FieldByName))) (designatorItem ( (expression (simpleExpression (factor (stringFactor 'PersonID')))) )) (designatorItem . (ident Value))))) (relOp =) (simpleExpression (factor (designator (namespacedQualifiedIdent (namespaceName (ident Module) . (ident mtPerson) . (ident Fields)) . (qualifiedIdent (ident FieldByName))) (designatorItem ( (expression (simpleExpression (factor (stringFactor 'PersonID')))) )) (designatorItem . (ident Value)))))) then (statement (compoundStatement begin (statementList (statement (simpleStatement (designator (namespacedQualifiedIdent (qualifiedIdent (ident Contact)))) := (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (namespaceName (ident TContact)) . (qualifiedIdent (ident Create))) (designatorItem ( (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (namespaceName (ident Module) . (ident mtContact) . (ident Fields)) . (qualifiedIdent (ident FieldByName))) (designatorItem ( (expression (simpleExpression (factor (stringFactor 'ContactID')))) )) (designatorItem . (ident Value)))))) , (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (namespaceName (ident Module) . (ident mtContact) . (ident Fields)) . (qualifiedIdent (ident FieldByName))) (designatorItem ( (expression (simpleExpression (factor (stringFactor 'PersonID')))) )) (designatorItem . (ident Value)))))) , (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (qualifiedIdent (ident IfNull))) (designatorItem ( (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (namespaceName (ident Module) . (ident mtContact) . (ident Fields)) . (qualifiedIdent (ident FieldByName))) (designatorItem ( (expression (simpleExpression (factor (stringFactor 'ContactType')))) )) (designatorItem . (ident Value)))))) , (expression (simpleExpression (factor (stringFactor '')))) )))))) , (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (qualifiedIdent (ident IfNull))) (designatorItem ( (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (namespaceName (ident Module) . (ident mtContact) . (ident Fields)) . (qualifiedIdent (ident FieldByName))) (designatorItem ( (expression (simpleExpression (factor (stringFactor 'Phone')))) )) (designatorItem . (ident Value)))))) , (expression (simpleExpression (factor (stringFactor '')))) )))))) , (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (qualifiedIdent (ident IfNull))) (designatorItem ( (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (namespaceName (ident Module) . (ident mtContact) . (ident Fields)) . (qualifiedIdent (ident FieldByName))) (designatorItem ( (expression (simpleExpression (factor (stringFactor 'Email')))) )) (designatorItem . (ident Value)))))) , (expression (simpleExpression (factor (stringFactor '')))) )))))) )))))))) ; (statement (simpleStatement (designator (namespacedQualifiedIdent (namespaceName (ident PersonView)) . (qualifiedIdent (ident AddContactToListBox))) (designatorItem ( (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (qualifiedIdent (ident Contact))))))) ))))) ; (statement (simpleStatement designator))) end)))) ; (statement (simpleStatement (designator (namespacedQualifiedIdent (namespaceName (ident Module) . (ident mtContact)) . (qualifiedIdent (ident Next)))))) ; (statement (simpleStatement designator))) end)))) ; (statement (simpleStatement (designator (namespacedQualifiedIdent (namespaceName (ident Module) . (ident mtPerson)) . (qualifiedIdent (ident Next)))))) ; (statement (simpleStatement designator))) end)))) ; (statement (simpleStatement designator))) end)))) ; (statement (simpleStatement designator))) end))) ;))) (declSection (procDecl (procDeclHeading procedure (ident PersonFields) (formalParameterSection ( (formalParameterList (formalParameter (identListFlat (ident Person)) : (typeDecl (typeId (namespacedQualifiedIdent (qualifiedIdent (ident TPerson))))))) ))) ; (procBody (block (blockBody (compoundStatement begin (statementList (statement (withStatement with (withItem (designator (namespacedQualifiedIdent (namespaceName (ident Module)) . (qualifiedIdent (ident mtPerson))))) do (statement (compoundStatement begin (statementList (statement (simpleStatement (designator (namespacedQualifiedIdent (namespaceName (ident Fields)) . (qualifiedIdent (ident FieldByName))) (designatorItem ( (expression (simpleExpression (factor (stringFactor 'PersonID')))) )) (designatorItem . (ident Value))) := (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (namespaceName (ident Person)) . (qualifiedIdent (ident PersonID))))))))) ; (statement (simpleStatement (designator (namespacedQualifiedIdent (namespaceName (ident Fields)) . (qualifiedIdent (ident FieldByName))) (designatorItem ( (expression (simpleExpression (factor (stringFactor 'ClientID')))) )) (designatorItem . (ident Value))) := (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (namespaceName (ident Person)) . (qualifiedIdent (ident Client))))))))) ; (statement (simpleStatement (designator (namespacedQualifiedIdent (namespaceName (ident Fields)) . (qualifiedIdent (ident FieldByName))) (designatorItem ( (expression (simpleExpression (factor (stringFactor 'LastName')))) )) (designatorItem . (ident Value))) := (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (namespaceName (ident Person)) . (qualifiedIdent (ident Last))))))))) ; (statement (simpleStatement (designator (namespacedQualifiedIdent (namespaceName (ident Fields)) . (qualifiedIdent (ident FieldByName))) (designatorItem ( (expression (simpleExpression (factor (stringFactor 'FirstName')))) )) (designatorItem . (ident Value))) := (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (namespaceName (ident Person)) . (qualifiedIdent (ident First))))))))) ; (statement (simpleStatement (designator (namespacedQualifiedIdent (namespaceName (ident Fields)) . (qualifiedIdent (ident FieldByName))) (designatorItem ( (expression (simpleExpression (factor (stringFactor 'Notes')))) )) (designatorItem . (ident Value))) := (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (namespaceName (ident Person)) . (qualifiedIdent (ident Notes))))))))) ; (statement (simpleStatement designator))) end)))) ; (statement (simpleStatement designator))) end))) ;))) (declSection (procDecl (procDeclHeading procedure (ident ContactFields) (formalParameterSection ( (formalParameterList (formalParameter (identListFlat (ident Contact)) : (typeDecl (typeId (namespacedQualifiedIdent (qualifiedIdent (ident TContact)))))) ; (formalParameter (identListFlat (ident PersonID)) : (typeDecl (typeId (namespacedQualifiedIdent (qualifiedIdent (ident Integer))))))) ))) ; (procBody (block (blockBody (compoundStatement begin (statementList (statement (withStatement with (withItem (designator (namespacedQualifiedIdent (namespaceName (ident Module)) . (qualifiedIdent (ident mtContact))))) do (statement (compoundStatement begin (statementList (statement (simpleStatement (designator (namespacedQualifiedIdent (namespaceName (ident Fields)) . (qualifiedIdent (ident FieldByName))) (designatorItem ( (expression (simpleExpression (factor (stringFactor 'ContactID')))) )) (designatorItem . (ident Value))) := (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (namespaceName (ident Contact)) . (qualifiedIdent (ident ID))))))))) ; (statement (simpleStatement (designator (namespacedQualifiedIdent (namespaceName (ident Fields)) . (qualifiedIdent (ident FieldByName))) (designatorItem ( (expression (simpleExpression (factor (stringFactor 'PersonID')))) )) (designatorItem . (ident Value))) := (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (qualifiedIdent (ident PersonID))))))))) ; (statement (simpleStatement (designator (namespacedQualifiedIdent (namespaceName (ident Fields)) . (qualifiedIdent (ident FieldByName))) (designatorItem ( (expression (simpleExpression (factor (stringFactor 'ContactType')))) )) (designatorItem . (ident Value))) := (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (namespaceName (ident Contact)) . (qualifiedIdent (ident ContactType))))))))) ; (statement (simpleStatement (designator (namespacedQualifiedIdent (namespaceName (ident Fields)) . (qualifiedIdent (ident FieldByName))) (designatorItem ( (expression (simpleExpression (factor (stringFactor 'Phone')))) )) (designatorItem . (ident Value))) := (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (namespaceName (ident Contact)) . (qualifiedIdent (ident Phone))))))))) ; (statement (simpleStatement (designator (namespacedQualifiedIdent (namespaceName (ident Fields)) . (qualifiedIdent (ident FieldByName))) (designatorItem ( (expression (simpleExpression (factor (stringFactor 'Email')))) )) (designatorItem . (ident Value))) := (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (namespaceName (ident Contact)) . (qualifiedIdent (ident Email))))))))) ; (statement (simpleStatement designator))) end)))) ; (statement (simpleStatement designator))) end))) ;))) declSection (declSection procedure AddPerson ( Person : TPerson ; Contacts : Array of TContact ) ;) (declSection (varSection (varKey var) (varDeclaration (identListFlat (ident I)) : (typeDecl (typeId (namespacedQualifiedIdent (qualifiedIdent (ident Integer))))) ;)))) (unitBlock (compoundStatement begin (statementList (statement (withStatement with (withItem (designator (namespacedQualifiedIdent (qualifiedIdent (ident Module))))) do (statement (compoundStatement begin (statementList (statement (simpleStatement (designator (namespacedQualifiedIdent (namespaceName (ident Module) . (ident mtPerson)) . (qualifiedIdent (ident Open)))))) ; (statement (simpleStatement (designator (namespacedQualifiedIdent (namespaceName (ident Module) . (ident mtPerson)) . (qualifiedIdent (ident Append)))))) ; (statement (simpleStatement (designator (namespacedQualifiedIdent (qualifiedIdent (ident PersonFields))) (designatorItem ( (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (qualifiedIdent (ident Person))))))) ))))) ; (statement (simpleStatement (designator (namespacedQualifiedIdent (namespaceName (ident Module) . (ident mtPerson)) . (qualifiedIdent (ident Post)))))) ; (statement (ifStatement if (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (qualifiedIdent (ident Length))) (designatorItem ( (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (qualifiedIdent (ident Contacts))))))) ))))) (relOp >) (simpleExpression (factor (intNum 0)))) then (statement (compoundStatement begin (statementList (statement (simpleStatement (designator (namespacedQualifiedIdent (namespaceName (ident mtContact)) . (qualifiedIdent (ident Open)))))) ; (statement (forStatement for (designator (namespacedQualifiedIdent (qualifiedIdent (ident I)))) := (expression (simpleExpression (factor (intNum 0)))) to (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (qualifiedIdent (ident Length))) (designatorItem ( (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (qualifiedIdent (ident Contacts))))))) )))) (operator -) (factor (intNum 1)))) do (statement (compoundStatement begin (statementList (statement (simpleStatement (designator (namespacedQualifiedIdent (namespaceName (ident mtContact)) . (qualifiedIdent (ident Append)))))) ; (statement (simpleStatement (designator (namespacedQualifiedIdent (qualifiedIdent (ident ContactFields))) (designatorItem ( (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (qualifiedIdent (ident Contacts))) (designatorItem [ (expressionList (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (qualifiedIdent (ident I)))))))) ]))))) , (expression (simpleExpression (factor (designator (namespacedQualifiedIdent (namespaceName (ident Person)) . (qualifiedIdent (ident PersonID))))))) ))))) ; (statement (simpleStatement designator))) end)))) ; (statement (simpleStatement (designator (namespacedQualifiedIdent (namespaceName (ident mtContact)) . (qualifiedIdent (ident Post)))))) ; (statement (simpleStatement designator))) end)))) ; (statement (simpleStatement designator))) end)))) ; (statement (simpleStatement designator))) end)) ; procedure EditPerson ( Person : TPerson ; Contacts : Array of TContact ) ; var I : Integer ; test : String ; begin with Module . mtPerson do begin if not Active then Open ; First ; while not EOF do begin if Fields . FieldByName ( 'PersonID' ) . Value = Person . PersonID then begin Edit ; PersonFields ( Person ) ; Break ; end else Next ; end ; end ; with Module . mtContact do begin if not Active then Open ; First ; while not EOF do begin test := Fields . FieldByName ( 'ContactID' ) . Value ; if Fields . FieldByName ( 'PersonID' ) . Value = Person . PersonID then begin Delete ; end else Next ; end ; First ; for I := 0 to Length ( Contacts ) - 1 do begin Append ; ContactFields ( Contacts [ I ] , Person . PersonID ) ; Post ; end ; end ; end ; procedure DeletePerson ( PersonID : Integer ) ; begin with Module . mtPerson do begin if not Active then Open ; First ; while not EOF do begin if Fields . FieldByName ( 'PersonID' ) . Value = PersonID then begin Edit ; Delete ; Break ; end else Next ; end ; end ; with Module . mtContact do begin if not Active then Open ; First ; while not EOF do begin if Fields . FieldByName ( 'PersonID' ) . Value = PersonID then begin Delete ; end else Next ; end ; end ; end ; end .))