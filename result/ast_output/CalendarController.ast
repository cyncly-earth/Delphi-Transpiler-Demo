{"name":"CalendarController","classes":[],"procedures":[{"name":"ItemClick","parameters":"(BookID:Integer)","returnType":"","body":"","hasBody":false,"span":{"startLine":11,"startColumn":0,"endLine":11,"endColumn":37}},{"name":"UpdateCalendar","parameters":"(StartDate:TDateTime;EndDate:TDateTime)","returnType":"","body":"","hasBody":false,"span":{"startLine":12,"startColumn":0,"endLine":12,"endColumn":68}},{"name":"EmailBitmap","parameters":"(Image:TBitmap;Email:String;EmailUser:TEmailUser;Body:String)","returnType":"","body":"","hasBody":false,"span":{"startLine":17,"startColumn":0,"endLine":17,"endColumn":93}},{"name":"ItemClick","parameters":"(BookID:Integer)","returnType":"","body":"varBooking:TBooking;beginBooking:=BookingsTabController.GetBookingByID(BookID);BookingsTabView.SwitchToBookings;BookingsTabController.SetEditBookingItem(Booking);end;","hasBody":true,"span":{"startLine":22,"startColumn":0,"endLine":29,"endColumn":3}},{"name":"UpdateCalendar","parameters":"(StartDate:TDateTime;EndDate:TDateTime)","returnType":"","body":"varLDataSetList:TFDJSONDataSets;CalendarItem:TCalendarItem;ItemStart:TDateTime;ItemEnd:TDateTime;beginModule.mtCalendar.Close;Module.mtCalendar.Open;CalendarView.Clear;LDataSetList:=ClientModule1.ServerMethods1Client.Calendar(StartDate,EndDate);Module.mtCalendar.AppendData(TFDJSONDataSetsReader.GetListValue(LDataSetList,0));withModule.mtCalendardobeginFirst;whilenotEOFdobeginItemStart:=FieldByName(\u0027StartDate\u0027).AsDateTime;ReplaceTime(ItemStart,EncodeTime(13,1,0,0));ItemEnd:=FieldByName(\u0027EndDate\u0027).AsDateTime;ReplaceTime(ItemEnd,EncodeTime(12,59,0,0));CalendarItem:=TCalendarItem.Create(FieldByName(\u0027BookID\u0027).Value,FieldByName(\u0027RentID\u0027).Value,FieldByName(\u0027AccomID\u0027).Value,IfNull(FieldByName(\u0027ClientID\u0027).Value,0),FieldByName(\u0027Status\u0027).Value,IfNull(FieldByName(\u0027Outstanding\u0027).Value,0),ItemStart,ItemEnd,FieldByName(\u0027AccomName\u0027).Value,IfNull(FieldByName(\u0027FirstName\u0027).Value,\u0027\u0027),IfNull(FieldByName(\u0027LastName\u0027).Value,\u0027\u0027),IfNull(FieldByName(\u0027Occupants\u0027).Value,0),IfNull(FieldByName(\u0027TravelInfo\u0027).Value,\u0027\u0027));CalendarView.AddItemToCalendar(CalendarItem);Next;end;end;end;","hasBody":true,"span":{"startLine":31,"startColumn":0,"endLine":74,"endColumn":3}},{"name":"EmailBitmap","parameters":"(Image:TBitmap;Email:String;EmailUser:TEmailUser;Body:String)","returnType":"","body":"varSuccess:Boolean;Stream:TMemoryStream;beginSuccess:=False;ifIsConnectedthenbegintryStream:=TMemoryStream.Create;Image.SaveToStream(Stream);Success:=ClientModule1.ServerMethods1Client.EmailBitmap(Stream,Email,EmailUser,Body);finallyifnotSuccessthenPrint(\u0027Error sending calendar.\u0027);ifSuccessthenPrint(\u0027Email Sent!\u0027);Image.Free;end;endelsebeginPrint(\u0027Cannot connect to the server.\u0027);end;end;","hasBody":true,"span":{"startLine":79,"startColumn":0,"endLine":103,"endColumn":3}}]}